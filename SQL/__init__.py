# -*- coding: utf-8-*-
import fellow
import typecheck

@fellow.app.task(name="sql.score_by_zipcode")
@typecheck.returns("184 * (string, number, number, count)")
def score_by_zipcode():
    return [('10001', 19.750465753424656, 0.16172391617084478, 9125),
 ('10002', 22.578967568604874, 0.1722592953543296, 10422),
 ('10003', 21.045247046186894, 0.12743638214181865, 14896),
 ('10004', 19.298287534846676, 0.2837610749631981, 2511),
 ('10005', 20.627888446215138, 0.4378687945630761, 1255),
 ('10006', 21.208092485549134, 0.3977820678942936, 1211),
 ('10007', 20.122359796067006, 0.2862123952935742, 2746),
 ('10009', 20.224014094050684, 0.17821852992758383, 7379),
 ('10010', 21.39724454649828, 0.22877246234127852, 5226),
 ('10011', 19.922606924643585, 0.14294352864476337, 9820),
 ('10012', 19.66907367708451, 0.14347391502553247, 8863),
 ('10013', 22.621567814184985, 0.15072846731990666, 12055),
 ('10014', 20.065189328743546, 0.14872306182421474, 9296),
 ('10016', 21.580645161290324, 0.1532390690920256, 9734),
 ('10017', 21.306489638913018, 0.16927445756478052, 8059),
 ('10018', 21.734151605071485, 0.18430456870955372, 7414),
 ('10019', 20.213231904103274, 0.12936569161918615, 13014),
 ('10020', 16.83901773533424, 0.4708566319016351, 733),
 ('10021', 21.512503512222533, 0.2693395536737962, 3559),
 ('10022', 20.782437241511975, 0.15564612263853853, 10397),
 ('10023', 20.534682080924856, 0.24074260238481987, 4152),
 ('10024', 20.926242066097615, 0.22818208247430674, 4569),
 ('10025', 22.05185185185185, 0.2149515856021184, 5400),
 ('10026', 22.420424403183024, 0.4302613243361538, 1508),
 ('10027', 21.39685595123516, 0.2938028942612734, 3117),
 ('10028', 19.84546643417611, 0.21032096219372742, 4588),
 ('10029', 22.196924603174605, 0.2805394549267225, 4032),
 ('10030', 19.341013824884794, 0.6453167658300927, 651),
 ('10031', 20.89902912621359, 0.33602076789031676, 2060),
 ('10032', 22.558595345038793, 0.35569817072630044, 2449),
 ('10033', 20.537528430629266, 0.2825634039191742, 2638),
 ('10034', 20.17699115044248, 0.29533183476123265, 2260),
 ('10035', 20.085848423876595, 0.3734914091514651, 1491),
 ('10036', 21.101854891661194, 0.1442593636110324, 12184),
 ('10037', 20.702857142857145, 0.560190906413895, 700),
 ('10038', 20.948189762796506, 0.26735547180006464, 3204),
 ('10039', 18.524590163934427, 0.49113794015523327, 549),
 ('10040', 20.917335473515248, 0.4962225136639787, 1246),
 ('10044', 18.455882352941178, 1.1069532436928107, 136),
 ('10065', 19.364422321194656, 0.20365571581436587, 3817),
 ('10075', 20.869293608841904, 0.36841657485609236, 2081),
 ('10103', 22.4811320754717, 2.5102310246788053, 106),
 ('10112', 14.801020408163266, 0.693995220309327, 196),
 ('10119', 22.004950495049506, 0.662744099529464, 404),
 ('10121', 15.689320388349515, 0.9917559165338, 103),
 ('10128', 21.881064596617687, 0.27084618400158117, 3607),
 ('10280', 22.54954954954955, 1.292783777117144, 222),
 ('10281', 21.037735849056602, 1.4421917019394752, 159),
 ('10282', 17.137566137566136, 1.378104121937598, 189),
 ('10301', 18.73784817039869, 0.3056089524492274, 1831),
 ('10302', 18.468599033816425, 0.34966091198036986, 1242),
 ('10303', 21.75743162901308, 0.5783950044205212, 841),
 ('10304', 20.27287716405606, 0.39024267028887916, 1213),
 ('10305', 19.4486646884273, 0.4261091542187558, 1685),
 ('10306', 17.74715615305067, 0.2828589800376873, 1934),
 ('10307', 16.66590909090909, 0.5823136547146585, 440),
 ('10308', 20.349951124144674, 0.515528676949799, 1023),
 ('10309', 19.217747949291574, 0.3547386471198212, 1341),
 ('10310', 20.50581915846016, 0.40692033076901213, 1117),
 ('10312', 19.230188679245284, 0.3813851180187182, 1325),
 ('10314', 19.836638058597217, 0.23525252146496245, 3379),
 ('10451', 21.29297006390851, 0.3082758195361355, 2973),
 ('10452', 20.298840704164878, 0.3141406575423423, 2329),
 ('10453', 20.836946277097077, 0.32870505309341863, 2122),
 ('10454', 19.766990291262136, 0.3489904404575091, 1751),
 ('10455', 21.443154329946783, 0.4048891265203915, 2067),
 ('10456', 21.16945107398568, 0.34071715835173033, 2095),
 ('10457', 19.819417475728155, 0.3780891376441074, 1545),
 ('10458', 20.554777388694347, 0.24118675857513724, 3998),
 ('10459', 19.392731535756155, 0.3480436752225013, 1706),
 ('10460', 18.481617647058822, 0.4612123752017939, 1088),
 ('10461', 19.32910547396529, 0.2949814590817537, 2996),
 ('10462', 19.754914394419785, 0.2823896760988948, 3154),
 ('10463', 19.96809722749715, 0.284972550775013, 2633),
 ('10464', 20.431873479318735, 0.5562229156456195, 822),
 ('10465', 19.86439588688946, 0.36454461348152484, 1556),
 ('10466', 20.384500745156483, 0.32222784059676896, 2013),
 ('10467', 19.78243814121907, 0.26363591840112277, 3314),
 ('10468', 20.687878787878788, 0.3814383527470564, 2310),
 ('10469', 20.17284595300261, 0.3458789713780619, 1915),
 ('10470', 20.02055498458376, 0.5235164184950095, 973),
 ('10471', 18.702210663198958, 0.4813920490309758, 769),
 ('10472', 19.332708528584817, 0.31454120967643096, 2134),
 ('10473', 25.061893203883496, 0.7208146517639152, 824),
 ('10474', 18.90026595744681, 0.5226561347321849, 752),
 ('10475', 20.132147395171536, 0.5566424324556919, 787),
 ('11004', 21.261467889908257, 0.7112290576775234, 654),
 ('11040', 21.636856368563684, 0.8083049734703903, 369),
 ('11101', 20.150027680383836, 0.20085039784940448, 5419),
 ('11102', 20.741740088105725, 0.37559629181542437, 1816),
 ('11103', 19.550148503541237, 0.23895454762949211, 4377),
 ('11104', 21.08320668693009, 0.2963414214101212, 2632),
 ('11105', 20.054632705795495, 0.2821655951457905, 2709),
 ('11106', 20.46512292738708, 0.27155200059846135, 3498),
 ('11201', 20.37537826685007, 0.1794416078237022, 7270),
 ('11203', 20.477227059611522, 0.27937074733562717, 2986),
 ('11204', 21.20171834142697, 0.30276710948674407, 2677),
 ('11205', 20.347852950262588, 0.25841192148699393, 3237),
 ('11206', 20.32175572519084, 0.2973426358577977, 2620),
 ('11207', 19.050922509225092, 0.2500244600991647, 2710),
 ('11208', 21.487234807623157, 0.2922452309520867, 2781),
 ('11209', 19.14433183183183, 0.20089761779882864, 5328),
 ('11210', 20.49576271186441, 0.38618849804837996, 1652),
 ('11211', 19.37904997254256, 0.17204494430885986, 7284),
 ('11212', 19.6586007364545, 0.3287937901131971, 1901),
 ('11213', 21.84517118037813, 0.37932871177935923, 1957),
 ('11214', 22.422815279958137, 0.26634220425846283, 3822),
 ('11215', 19.99496411935037, 0.16518420440967743, 7943),
 ('11216', 21.65787257928712, 0.27289217757241346, 3563),
 ('11217', 19.19419237749546, 0.20477839009819157, 4959),
 ('11218', 22.466666666666665, 0.28492998154054866, 3390),
 ('11219', 20.84069668649108, 0.3082231840935191, 2354),
 ('11220', 24.56314545228319, 0.19869832165178647, 8037),
 ('11221', 20.92766174223128, 0.41329084119313514, 1963),
 ('11222', 20.663147051249034, 0.2481844471521246, 3883),
 ('11223', 20.219473264166, 0.2741898525559515, 3759),
 ('11224', 17.29162656400385, 0.4650708633951296, 1039),
 ('11225', 20.271909047844623, 0.3050916316519782, 2111),
 ('11226', 23.12906116961685, 0.2670687233818181, 4463),
 ('11228', 18.584851390220518, 0.39237481150580567, 1043),
 ('11229', 21.057433541188054, 0.27745883277860445, 3047),
 ('11230', 22.11261980830671, 0.3371524357334663, 2504),
 ('11231', 19.70773732119636, 0.27280036388845075, 3076),
 ('11232', 20.700271247739604, 0.339564840444753, 2212),
 ('11233', 20.19699812382739, 0.5212591346744305, 1066),
 ('11234', 17.6644245142003, 0.25604832325923876, 2676),
 ('11235', 21.348993288590606, 0.2962979088707535, 3576),
 ('11236', 21.193872666347534, 0.3663993576168878, 2089),
 ('11237', 20.01544739143107, 0.23485884940129942, 3431),
 ('11238', 19.805848204687162, 0.2282765720039058, 4651),
 ('11239', 21.247252747252748, 1.229927900916062, 182),
 ('11249', 18.3862382343395, 0.22671217558477075, 3081),
 ('11354', 25.115358283888636, 0.21047475176108116, 8764),
 ('11355', 23.730006397952653, 0.2359186278877703, 4689),
 ('11356', 18.72061855670103, 0.4760875730804635, 970),
 ('11357', 18.37191934279313, 0.31362487468140204, 1339),
 ('11358', 20.374623367927686, 0.2720451164184876, 2987),
 ('11360', 18.7737881508079, 0.5217537050918369, 557),
 ('11361', 18.497338065661047, 0.29105793244399125, 2254),
 ('11362', 23.460303300624442, 0.5863028379046786, 1121),
 ('11363', 18.751381215469614, 0.7151889053760118, 362),
 ('11364', 20.07944732297064, 0.4537916173390605, 1158),
 ('11365', 18.92892892892893, 0.3980089262671853, 999),
 ('11366', 20.7279843444227, 0.5067155870754485, 1022),
 ('11367', 20.416666666666668, 0.46864882207364117, 984),
 ('11368', 22.199937762564183, 0.20758985129716956, 6427),
 ('11369', 19.387514060742408, 0.3476264336104821, 1778),
 ('11370', 22.37784522003035, 0.727649006653304, 659),
 ('11371', 20.586206896551722, 0.8815004845360045, 232),
 ('11372', 22.705591902234293, 0.19523102958820726, 8101),
 ('11373', 23.213443830570903, 0.2249764045203057, 5430),
 ('11374', 20.13463414634146, 0.3120055170173742, 2050),
 ('11375', 19.520417633410673, 0.19479410890463383, 4310),
 ('11377', 20.607510729613733, 0.21334752677201832, 4660),
 ('11378', 20.057522123893804, 0.3057555013653713, 1808),
 ('11379', 18.47177033492823, 0.3487380962828246, 1045),
 ('11385', 20.47795910710936, 0.22553322428568218, 5331),
 ('11411', 24.112084063047284, 0.7420435002075897, 571),
 ('11412', 19.155216284987276, 0.5044973719285845, 786),
 ('11413', 21.316017316017316, 0.6631055968381315, 693),
 ('11414', 21.03105590062112, 0.45393414446519537, 1127),
 ('11415', 20.602244389027433, 0.6158250435137141, 802),
 ('11416', 22.05801376597837, 0.5616469278572908, 1017),
 ('11417', 19.376569037656903, 0.3896025365060561, 1434),
 ('11418', 21.125421822272216, 0.38359138885926347, 1778),
 ('11419', 22.856512141280355, 0.3736008241162361, 2265),
 ('11420', 21.320372398685652, 0.39480592942883913, 1826),
 ('11421', 20.069138906348208, 0.3337010332579346, 1591),
 ('11422', 21.416378316032294, 0.519615503281114, 867),
 ('11423', 20.826801517067004, 0.6216333605428069, 791),
 ('11426', 19.261755485893417, 0.6031415717017046, 638),
 ('11427', 19.74484536082474, 0.8616398944090047, 388),
 ('11428', 24.07910074937552, 0.4710335677559537, 1201),
 ('11429', 18.63176895306859, 0.5490619454527277, 554),
 ('11430', 18.723125327739904, 0.3187680000259557, 1907),
 ('11432', 21.334426229508196, 0.26407898813058667, 3965),
 ('11433', 17.0173775671406, 0.3937503004978114, 633),
 ('11434', 20.80311995696611, 0.36523873695836095, 1859),
 ('11435', 20.235496183206106, 0.27801232032527545, 2620),
 ('11436', 21.5829307568438, 0.6391927245787882, 621),
 ('11691', 23.020684168655528, 0.435037666679909, 1257),
 ('11692', 18.15, 0.9828643048993737, 140),
 ('11693', 21.134357005758158, 0.7333303825917884, 521),
 ('11694', 21.389010989010988, 0.4638371114306071, 910)]


@fellow.app.task(name="sql.score_by_map")
@typecheck.returns("string")
def score_by_map():
    # must be url starting with ctb.io
    return "http://cdb.io/"

@fellow.app.task(name="sql.score_by_borough")
@typecheck.returns("5 * (string, number, number, count)")
def score_by_borough():
    return [('STATEN ISLAND', 19.37282871275739, 0.10706295846600054, 17386),
 ('THE BRONX', 20.220328529429906, 0.071172271471837, 48641),
 ('BROOKLYN', 20.68926287176207, 0.04439474801785955, 125080),
 ('MANHATTAN', 20.90015237235938, 0.033280690323082764, 217231),
 ('QUEENS', 21.252587170226892, 0.04565104618156244, 123494)]

@fellow.app.task(name="sql.score_by_cuisine")
@typecheck.returns("75 * (string, number, number, count)")
def score_by_cuisine():
    return [('Other', 11.051060769507371, 0.36502101968711737, 2781),
 ('Hotdogs/Pretzels', 13.482142857142858, 1.0003916170255032, 168),
 ('Soups & Sandwiches', 14.281144781144782, 0.40940736861991633, 594),
 ('Ethiopian', 14.63, 0.425201833030848, 300),
 ('Donuts', 14.652194138626143, 0.14352764563010978, 6449),
 ('Hotdogs', 14.71822033898305, 0.4393868291224805, 472),
 ('Ice Cream, Gelato, Yogurt, Ices',
  14.730250990752973,
  0.1952204514252207,
  3785),
 ('Armenian', 15.079268292682928, 0.40865664646012256, 656),
 ('Cajun', 15.548387096774194, 0.5886086483756457, 186),
 ('Egyptian', 15.662125340599456, 0.6230174095024664, 367),
 ('Sandwiches', 15.712999099369558, 0.14547803792438158, 6662),
 ('Cafxe9/Coffee/Tea', 15.994683295044306, 0.1034563357741395, 15235),
 ('Juice, Smoothies, Fruit Salads',
  16.003679175864605,
  0.2383271585016445,
  2718),
 ('Sandwiches/Salads/Mixed Buffet',
  16.340146917917597,
  0.22072423684354653,
  3131),
 ('Hamburgers', 16.577529232333504, 0.1324045098073057, 7868),
 ('Bottled beverages, including water, sodas, juices, etc.',
  16.74928774928775,
  0.40427666581749305,
  1053),
 ('English', 17.33625730994152, 0.5827276488437098, 342),
 ('Middle Eastern', 17.706328375619716, 0.27359288071510046, 3429),
 ('Chicken', 17.836702546600158, 0.15341128851846425, 7618),
 ('Southwestern', 18.004830917874397, 0.6890354941307909, 207),
 ('German', 18.627986348122867, 0.3745124413929537, 879),
 ('Czech', 18.83969465648855, 1.1462902012976184, 131),
 ('Tapas', 18.86813186813187, 0.6659220331660752, 637),
 ('Not Listed/Not Applicable', 18.899280575539567, 1.8158934224350856, 139),
 ('Moroccan', 18.95205479452055, 0.8889892346941003, 292),
 ('Greek', 19.296904852884982, 0.2752212646754072, 2617),
 ('Scandinavian', 19.409395973154364, 0.8222160534429127, 149),
 ('Irish', 19.484177915468024, 0.2031900837710234, 4519),
 ('Salads', 19.583184257602863, 0.5961050629677913, 559),
 ('Tex-Mex', 19.680333564975676, 0.2888837252529681, 2878),
 ('Pancakes/Waffles', 19.75771971496437, 0.6880535276726526, 421),
 ('Barbecue', 19.811274509803923, 0.4544789183605485, 816),
 ('American ', 19.829074876141213, 0.041713159443338095, 128372),
 ('Afghan', 19.850162866449512, 0.8331112724698654, 307),
 ('Polish', 19.916666666666668, 0.45085183154561637, 732),
 ('Mediterranean', 19.940456578018356, 0.24783444765941268, 4249),
 ('Bagels/Pretzels', 19.97826086956522, 0.23343476916521774, 3726),
 ('Vegetarian', 20.008572869389813, 0.3437064661489934, 1983),
 ('Pizza', 20.068807514605368, 0.09176618080188305, 26189),
 ('Steak', 20.164041281912006, 0.38936685948790184, 1841),
 ('French', 20.35480464625132, 0.17709974717651142, 7576),
 ('Australian', 20.41732283464567, 1.124588206384589, 254),
 ('Continental', 20.513432835820897, 0.4530531186418449, 1005),
 ('Filipino', 20.558260869565217, 0.5393487636887532, 575),
 ('Italian', 20.63513306821658, 0.09316033631827199, 26152),
 ('Eastern European', 20.78488372093023, 0.39932667906544456, 1548),
 ('Pizza/Italian', 20.86207214687702, 0.13975090047795347, 10839),
 ('Russian', 21.237182558696695, 0.391793449530072, 2087),
 ('Brazilian', 21.24041297935103, 0.5102183790932577, 678),
 ('Seafood', 21.275090689238212, 0.2972057876192947, 3308),
 ('Turkish', 21.359666024405907, 0.4004674963029919, 1557),
 ('Indonesian', 21.455813953488374, 0.813936014469031, 215),
 ('Mexican', 21.637887901208284, 0.11262608403357988, 18787),
 ('Jewish/Kosher', 21.667366211962225, 0.17342539270741766, 7624),
 ('Caribbean', 21.765419307654803, 0.12649473014067292, 16408),
 ('Bakery', 21.82458066483684, 0.12982566974763335, 16395),
 ('Spanish', 21.955502284815342, 0.13941442216991246, 13349),
 ('Soul Food', 22.223823246878002, 0.45592555815054037, 1041),
 ('Thai', 22.51648193464805, 0.1769572511899275, 6947),
 ('Japanese', 22.559875583203734, 0.11447723411350752, 18647),
 ('Latin (Cuban, Dominican, Puerto Rican, South & Central American)',
  22.92815885839405,
  0.1027774699594768,
  26489),
 ('Portuguese', 22.940350877192984, 1.1079022099407372, 285),
 ('Korean', 23.086021505376344, 0.19530237824845778, 7068),
 ('Delicatessen', 23.247045524612066, 0.16235492849437935, 9731),
 ('Vietnamese/Cambodian/Malaysia',
  23.448814655172413,
  0.3722490747522786,
  1856),
 ('Peruvian', 23.529473135106937, 0.3972456021278627, 1917),
 ('Indian', 23.86602409638554, 0.2024034646705623, 8300),
 ('Chinese', 23.942464820699048, 0.06816574861933593, 61684),
 ('Pakistani', 24.266265060240965, 0.6415148865470445, 830),
 ('Asian', 24.586526099254307, 0.21557599197048327, 7778),
 ('Chinese/Japanese', 25.0666161998486, 0.4581240303898391, 1321),
 ('African', 25.394778902503997, 0.4548654080746962, 1877),
 ('Bangladeshi', 25.443488943488944, 0.6541898062400501, 814),
 ('Chinese/Cuban', 26.248306997742663, 0.8218178838154246, 443),
 ('Creole', 28.96069868995633, 0.8280390563340794, 687)]

@fellow.app.task(name="sql.violation_by_cuisine")
@typecheck.returns("20 * ((string, string), number, count)")
def violation_by_cuisine():
    return [(('Japanese',
   'Food worker does not use proper utensil to eliminate bare hand contact with food that will not receive adequate additional heat treatment.'),
  3.265525983435347,
  541),
 (('Cafxe9/Coffee/Tea',
   'x93Choking first aidx94 poster not posted. x93Alcohol and pregnancyx94 warning sign not posted. Resuscitation equipment: exhaled air resuscitation masks (adult & pediatric), latex gloves, sign not posted. Inspection report sign not posted.'),
  3.1414818233282684,
  175),
 (('Juice, Smoothies, Fruit Salads',
   'Food Protection Certificate not held by supervisor of food operations.'),
  3.063222689585581,
  145),
 (('Donuts',
   'Accurate thermometer not provided in refrigerated or hot holding equipment.'),
  3.0324753951821077,
  130),
 (('Ice Cream, Gelato, Yogurt, Ices',
   'Food Protection Certificate not held by supervisor of food operations.'),
  2.927867679436372,
  193),
 (('Thai', 'Thawing procedures improper.'), 2.6494362448587756, 151),
 (('Irish',
   'Raw, cooked or prepared food is adulterated, contaminated, cross-contaminated, or not discarded in accordance with HACCP plan.'),
  2.368381554925711,
  321),
 (('Mexican',
   'Food not cooled by an approved method whereby the internal product temperature is reduced from 140xba F to 70xba F or less within 2 hours, and from 70xba F to 41xba F or less within 4 additional hours.'),
  2.329632394606289,
  260),
 (('Indian',
   'Food not cooled by an approved method whereby the internal product temperature is reduced from 140xba F to 70xba F or less within 2 hours, and from 70xba F to 41xba F or less within 4 additional hours.'),
  2.271493060850999,
  112),
 (('Chinese', 'Thawing procedures improper.'), 2.215169223720365, 1121),
 (('Caribbean',
   'Food not cooled by an approved method whereby the internal product temperature is reduced from 140xba F to 70xba F or less within 2 hours, and from 70xba F to 41xba F or less within 4 additional hours.'),
  2.113406589252541,
  206),
 (('Chinese',
   'Food worker does not wash hands thoroughly after using the toilet, coughing, sneezing, smoking, eating, preparing raw foods or otherwise contaminating hands.'),
  2.1037287012787336,
  121),
 (('Hamburgers',
   'Accurate thermometer not provided in refrigerated or hot holding equipment.'),
  2.084051549376937,
  109),
 (('American ',
   '"No Smokingx94 and/or Smoking Permittedx94 sign not conspicuously posted. Health warning not present on Smoking Permittedx94'),
  2.076423400150047,
  227),
 (('Soups & Sandwiches',
   'Cold food item held above 41xba F (smoked fish and reduced oxygen packaged foods above 38 xbaF) except during necessary preparation.'),
  2.071726305886807,
  106),
 (('Donuts',
   'Bulb not shielded or shatterproof, in areas where there is extreme heat, temperature changes, or where accidental contact may occur.'),
  2.0616147199238504,
  110),
 (('Middle Eastern',
   'Food Protection Certificate not held by supervisor of food operations.'),
  1.9591983077892465,
  117),
 (('Spanish',
   'Food not cooled by an approved method whereby the internal product temperature is reduced from 140xba F to 70xba F or less within 2 hours, and from 70xba F to 41xba F or less within 4 additional hours.'),
  1.9041436043661355,
  151),
 (('Hamburgers',
   'Filth flies or food/refuse/sewage-associated (FRSA) flies present in facilityx92s food and/or non-food areas. Filth flies include house flies, little house flies, blow flies, bottle flies and flesh flies. Food/refuse/sewage-associated flies include fruit flies, drain flies and Phorid flies.'),
  1.8860162837459709,
  600),
 (('Cafxe9/Coffee/Tea',
   'Toilet facility not maintained and provided with toilet paper, waste receptacle and self-closing door.'),
  1.876847758271718,
  315)] 
